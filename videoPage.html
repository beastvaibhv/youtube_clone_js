<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./assets/images/Group.svg" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style1.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <title>Document</title>
</head>
<body>
    <header>
        <div class="logoRight"  >
          <a class="bars" href=""><img src="./assets/images/hamburger.svg" alt=""></a>
          <a href="index.html" class="logoText">
            <img src="./assets/images/Youtube-Logo.svg" alt="">
          </a>
        </div>
  
        <!-- Search  Bar -->
        <div class="SearchBar"  >
          <input type="text" placeholder="Search" class="searchInput">
          <button class="searchBtn" href="index.html"><i class="fa-solid fa-magnifying-glass"></i></button>
          <a href="#" class="mic"><i class="fa-solid fa-microphone"></i></a>
        </div>
  
        <div class="ProfileRight"  >
          <a href="#" id="createVid"><img src="assets/images/u1.svg" alt=""></a>
          <a id="dots" href="#"><img src="assets/images/apps.svg" alt=""></a>
          <a href="#"><img class="notiBell" src="assets/images/Notifications.svg" alt=""></a>
          <img class="profile" src="assets/images/Profile-pic.svg" alt="Profile">
        </div>
      </header>

      <div class="video-page-container">

        <div class="video-cmnts-container">

            <div class="video">
                <div class="video-container">
                    
                </div>
                <div class="video-info">
                <div class="title"><p class="text-wrapper"></p>
                </div>
                   <div class="info">
                    <div>
                       <div class="info-text">
            <p class="time">576,969</p>
                       </div>
                       <div class="top-level">
          <button class="button">
            <div class="button-btn"><span class="material-symbols-outlined">
                thumb_up
                </span></div>
            <div class="button-text"><div class="element">1.7 K</div></div>
          </button>
          <button class="button">
            <div class="button-btn"><span class="material-symbols-outlined">
                thumb_down
                </span></div>
            <div class="button-text"><div class="element dislike">632</div></div>
          </button>
          <button class="button">
            <div class="button-btn"><span class="material-symbols-outlined">
                share
                </span></div>
            <button class="element-wrapper"><div class="element">SHARE</div></button>
          </button>
          <button class="button">
            <div class="button-btn"><span class="material-symbols-outlined">
                playlist_add
                </span></div>
            <button class="element-wrapper"><div class="element">SAVE</div></button>
          </button>
          <div class="div">
            <div class="button-btn"><span class="material-symbols-outlined">
                more_horiz
                </span></div>
          </div>
                       </div>
                    </div>
                    
                  </div>

                </div>
                <div class="subscribe">
                  <div class="channel">
                    <div class="channel-left">
                      <span class="channel-logo"><img width="50px" src="./assets/images/IconAnna .svg" alt=""></span>
                      <span class="channel-basic">
                        <div class="channel-name"></div>
                        <div class="channel-suscriber">1.2M Subscriber</div>

                      </span>
                    </div>
                    <div class="suscribe-btn">
                      <span>Subscribe</span>
                    </div>

                  </div>
                  <div class="channel-about">
                    <p>Chris Fisher, also known as the Blind Woodturner, learned his craft by
                       listening to hundreds of hours of YouTube videos and experimenting in 
                       his workshop. Now heâ€™s a YouTube creator himself, sells his products worldwide, 
                       and does demonstrations all around the country.</p>
 
                  </div>
                </div>
            </div>
            <div class="comment">
              <div class="cmnt-top">
                <span class="cmnt-num"></span>
                <span class="sort"><img src="./assets/images/Iconsort.svg" alt=""> Sort By</span>
              </div>
              <div class="write">
                <span><img src="./assets/images/Profile-pic.svg" alt="user"></span>
                <span class="write-cmnt">Add a public comment</span>
              </div>
              <div class="video-cmnt">

              </div>


            </div>
            

        </div>
        <div class="suggestion-container">
         


        </div>



      </div>
  

      <script src="script.js"></script>
<script >

  const vidTitle = document.querySelector('.text-wrapper');
  const chanelName = document.querySelector('.channel-name');
  document.addEventListener('DOMContentLoaded', () => {
    
    const storedData = JSON.parse(localStorage.getItem('selectedVideoTitleAndId'))    
    if (storedData) {
    const { title: videoTitle, id: videoID, channelName: videoChannelName  } = storedData;
    fetchAndDisplayVideo(videoID);
    chanelName.textContent = videoChannelName;
    
    vidTitle.textContent = videoTitle;

  } else {
    console.log('No video details found in localStorage.');
  }
});




function fetchAndDisplayVideo(videoId) {
embedVideo(videoId);
getVideoStatistics(videoId);
//line 251
fetchVideoComments(videoId)
  .then(comments => {
    displayVideoComment(comments);
    
    // Process the comments further or update UI
  });
/*apiUrl = `${baseUrl}/videos/id=${videoId}&key=${apiKey}&part=snippet`
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            const videoData = data.items[0].snippet;
            console.log('Video Title:', videoData.title);
            console.log('Channel Title:', videoData.channelTitle);
            // Access other video details as needed
        })
        .catch(error => console.error('Error fetching video data:', error));

*/
    
}

const videoContainer = document.querySelector('.video-container');


function embedVideo(videoId) {
    videoContainer.innerHTML = '';
    
    
    const iEmbed = document.createElement('iframe');
  iEmbed.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
  iEmbed.allow = "accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
  iEmbed.width = "560"; // Set width and height accordingly
  iEmbed.height = "315";
  iEmbed.allowFullscreen = true; // Allow fullscreen mode
  videoContainer.appendChild(iEmbed);
}
const views= document.querySelector('.time');
const likes = document.querySelector('.element');
const dislikes = document.querySelector('.dislike');
const comntCount = document.querySelector('.cmnt-num');


async function getVideoStatistics(videoId) {
  const apiUrl = `https://www.googleapis.com/youtube/v3/videos?part=statistics&id=${videoId}&key=${apiKey}`;

  try {
    const response = await fetch(apiUrl);
    const data = await response.json();

    if (data.items && data.items.length > 0) {
      
      const statistics = data.items[0].statistics;
      
      views.textContent = `${statistics.viewCount} views . Oct 8, 2021`;
      likes.textContent = `${statistics.likeCount/1000} k`;
      comntCount.textContent = `${statistics.commentCount} Comments`;
     
    } else {
      throw new Error('Video not found or statistics unavailable.');
    }
  } catch (error) {
    console.error('Error fetching video statistics:', error.message);
    return null;
  }
}
 

function fetchVideoComments(videoId) {
  const apiUrl = `https://www.googleapis.com/youtube/v3/commentThreads?part=snippet&videoId=${videoId}&key=${apiKey}`;

  return fetch(apiUrl)
    .then(response => response.json())
    .then(data => {
      console.log(data);
      return data.items;
      
    })
    .catch(error => {
      console.error('Error fetching video comments:', error);
      return [];
    });
}

const commentContainer = document.querySelector(".video-cmnt")
function displayVideoComment(comments){

  comments.map(cmnt => {
    const commentText = document.createElement('div');
    const comment = cmnt.snippet.topLevelComment.snippet.textOriginal;
    const authorName = cmnt.snippet.topLevelComment.snippet.authorDisplayName;
    commentText.innerHTML =`<div class='comment-text'>
      <span class="cmnt-img" ><img src="./assets/images/IconAlanCooper.svg" alt="user-image"></span>
      <span>
        <div class="cmnt-user-name"> ${authorName}</div>
        <p>${comment}<p/>
          </span>
      </div>`
    commentContainer.appendChild(commentText);
  })
}
      </script>
    
</body>

</html>